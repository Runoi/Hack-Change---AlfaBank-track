# üöÄ AI Microservice: Scoring & Offers

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ ML-–º–æ–¥–µ–ª–∏ –≤ –±–∞–Ω–∫–æ–≤—Å–∫–∏–π –∫–æ–Ω—Ç—É—Ä. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç REST API –¥–ª—è —Å–∫–æ—Ä–∏–Ω–≥–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π "Next Best Action".

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
*   **–¢–æ—á–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–Ω—Å–∞–º–±–ª—å (LGBM + CatBoost + ResNet).
*   **Explainable AI:** –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç **SHAP-values** (–ø–æ—á–µ–º—É –º–æ–¥–µ–ª—å –ø—Ä–∏–Ω—è–ª–∞ —Ç–∞–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ) –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ Waterfall-–≥—Ä–∞—Ñ–∏–∫–æ–≤.
*   **Business Engine:** –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ñ—Ñ–µ—Ä—ã (–ö—Ä–µ–¥–∏—Ç–∫–∏, –ò–ø–æ—Ç–µ–∫–∞, –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏) –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∏–Ω. –ø—Ä–æ—Ñ–∏–ª—è –∫–ª–∏–µ–Ω—Ç–∞.
*   **Swagger UI:** –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è.

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –ó–∞–ø—É—Å–∫

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–æ–¥–µ–ª–µ–π
–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –æ–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∏–∑ –ø–∞–ø–∫–∏ `pipeline/submissions/` –≤ –ø–∞–ø–∫—É `ml_service/models/`:
*   `model_catboost.cbm`
*   `model_lgbm.pkl`
*   `lgbm_artifacts.pkl` (—Å–ø–∏—Å–æ–∫ —Ñ–∏—á–µ–π)
*   `catboost_artifacts.pkl`
*   `model_nn_artifacts.pth` (–≤–µ—Å–∞ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏)
*   `features.json`


–¢–∞–∫–∂–µ –ø–æ–ª–æ–∂–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –¥–∞—Ç–∞—Å–µ—Ç `hackathon_income_test.csv` –≤ –ø–∞–ø–∫—É `ml_service/data/`.

### 2. –ó–∞–ø—É—Å–∫ –≤ Docker
```bash
cd ml_service
docker-compose up --build -d
```

–°–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: **http://localhost:8000**

## üîå API Endpoints

### 1. –ê–Ω–∞–ª–∏–∑ –∫–ª–∏–µ–Ω—Ç–∞ (–î–ª—è –¥–µ–º–æ)
`GET /ClientAnalysis/{client_id}`
–ü–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ ID –∏–∑ CSV, –ø—Ä–æ–≥–æ–Ω—è–µ—Ç —á–µ—Ä–µ–∑ –º–æ–¥–µ–ª–∏ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç.

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "client_id": "10502",
  "predicted_income": 365400.0,
  "offers": [
    {
      "title": "Alfa Premium",
      "client_message": "–í–∞–º –¥–æ—Å—Ç—É–ø–Ω–æ –ø—Ä–µ–º–∏–∞–ª—å–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ...",
      "priority": 100
    }
  ],
  "explainability": [
    { "feature": "salary_avg", "impact": 25000 }
  ]
}
```

### 2. –ü—Ä—è–º–æ–π —Å–∫–æ—Ä–∏–Ω–≥
`POST /predict`
–ü—Ä–∏–Ω–∏–º–∞–µ—Ç JSON —Å —Ñ–∏—á–∞–º–∏ –∫–ª–∏–µ–Ω—Ç–∞, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ–≥–Ω–æ–∑ –∏ –æ—Ñ—Ñ–µ—Ä—ã.

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
–í–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤:

```bash
# –¢–µ—Å—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ñ—Ñ–µ—Ä–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–µ—Ä—Å–æ–Ω (–°—Ç—É–¥–µ–Ω—Ç, VIP, –ó–∞–µ–º—â–∏–∫)
python test_offers.py

# –¢–µ—Å—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API
python test_endpoints.py

# –¢–µ—Å—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Docer –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
python test_docker.py
```